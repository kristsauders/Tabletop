{"ts":1348707386980,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var REV = 6,\n       BRUSHES = [\"sketchy\", \"shaded\", \"chrome\", \"fur\", \"longfur\", \"web\", \"\", \"simple\", \"squares\", \"ribbon\", \"\", \"circles\", \"grid\"],\n       USER_AGENT = navigator.userAgent.toLowerCase();\nvar SCREEN_WIDTH = window.innerWidth,\n    SCREEN_HEIGHT = Math.max(\n\t        Math.max(document.body.scrollHeight, document.documentElement.scrollHeight),\n\t        Math.max(document.body.offsetHeight, document.documentElement.offsetHeight),\n\t        Math.max(document.body.clientHeight, document.documentElement.clientHeight))+50,\n    BRUSH_SIZE = 1,\n    BRUSH_PRESSURE = 1,\n    COLOR = [250, 250, 250],\n    BACKGROUND_COLOR = [51, 51, 51],\n    STORAGE = window.localStorage,\n    brush,\n    saveTimeOut,\n    wacom,\n    i,\n    mouseX = 0,\n    mouseY = 0,\n    container,\n    foregroundColorSelector,\n    backgroundColorSelector,\n    menu,\n    about,\n    canvas,\n    flattenCanvas,\n    context,\n    isFgColorSelectorVisible = false,\n    isBgColorSelectorVisible = false,\n    isAboutVisible = false,\n    isMenuMouseOver = false,\n    shiftKeyIsDown = false,\n    altKeyIsDown = false;\n\ninit();\n\nvar coords = [0,0];\nfunction getCoords(e){\nvar x, y;\nif (self.pageYOffset) // all except Explorers\n{\nx = self.pageXOffset; // not used in event code\ny = self.pageYOffset; // not used in event code\n}\nelse if(document.documentElement\n&& document.documentElement.scrollTop) // Explorer 6 Strict\n{\nx = document.documentElement.scrollLeft;\ny = document.documentElement.scrollTop;\n}\nelse if (document.body) // all other Explorers\n{\nx = document.body.scrollLeft;\ny = document.body.scrollTop;\n}\ncoords[0] = (document.all) ? x + event.clientX : e.pageX;\ncoords[1] = (document.all) ? y + event.clientY : e.pageY;\nreturn true;\n}\nif (!document.all) document.captureEvents(Event.MOUSEMOVE);\ndocument.onmousemove = getCoords;\n\nfunction init()\n{\n\tvar hash, palette, embed, localStorageImage;\n\t\n\tif (USER_AGENT.search(\"android\") > -1 || USER_AGENT.search(\"iphone\") > -1)\n\t\tBRUSH_SIZE = 2;\t\n\t\t\n\tif (USER_AGENT.search(\"safari\") > -1 && USER_AGENT.search(\"chrome\") == -1) // Safari\n\t\tSTORAGE = false;\n\t\n\tdocument.body.style.backgroundRepeat = 'no-repeat';\n\tdocument.body.style.backgroundPosition = 'center center';\t\n\t\n\tcontainer = document.createElement('div');\n\tdocument.body.appendChild(container);\n\n\t/*\n\t * TODO: In some browsers a naste \"Plugin Missing\" window appears and people is getting confused.\n\t * Disabling it until a better way to handle it appears.\n\t * \n\t * embed = document.createElement('embed');\n\t * embed.id = 'wacom-plugin';\n\t * embed.type = 'application/x-wacom-tablet';\n\t * document.body.appendChild(embed);\n\t *\n\t * wacom = document.embeds[\"wacom-plugin\"];\n\t */\n\n\tcanvas = document.createElement(\"canvas\");\n\tcanvas.width = SCREEN_WIDTH-17;\n\tcanvas.height = SCREEN_HEIGHT;\n\tcanvas.style.cursor = 'crosshair';\n\tcontainer.appendChild(canvas);\n\t\n\tcontext = canvas.getContext(\"2d\");\n\t\n\tflattenCanvas = document.createElement(\"canvas\");\n\tflattenCanvas.width = SCREEN_WIDTH-17;\n\tflattenCanvas.height = SCREEN_HEIGHT;\n\t\n\tpalette = new Palette();\n\t\n\tforegroundColorSelector = new ColorSelector(palette);\n\tforegroundColorSelector.addEventListener('change', onForegroundColorSelectorChange, false);\n\tcontainer.appendChild(foregroundColorSelector.container);\n\n\tbackgroundColorSelector = new ColorSelector(palette);\n\tbackgroundColorSelector.addEventListener('change', onBackgroundColorSelectorChange, false);\n\tcontainer.appendChild(backgroundColorSelector.container);\t\n\t\n\tmenu = new Menu();\n\tmenu.foregroundColor.addEventListener('click', onMenuForegroundColor, false);\n\tmenu.foregroundColor.addEventListener('touchend', onMenuForegroundColor, false);\n\tmenu.backgroundColor.addEventListener('click', onMenuBackgroundColor, false);\n\tmenu.backgroundColor.addEventListener('touchend', onMenuBackgroundColor, false);\n\tmenu.selector.addEventListener('change', onMenuSelectorChange, false);\n\tmenu.save.addEventListener('click', onMenuSave, false);\n\tmenu.save.addEventListener('touchend', onMenuSave, false);\n\tmenu.clear.addEventListener('click', onMenuClear, false);\n\tmenu.clear.addEventListener('touchend', onMenuClear, false);\n\t//menu.about.addEventListener('click', onMenuAbout, false);\n\t//menu.about.addEventListener('touchend', onMenuAbout, false);\n\tmenu.container.addEventListener('mouseover', onMenuMouseOver, false);\n\tmenu.container.addEventListener('mouseout', onMenuMouseOut, false);\n\tcontainer.appendChild(menu.container);\n\tif (STORAGE)\n\t{\n\t\tif (localStorage.canvas)\n\t\t{\n\t\t\tlocalStorageImage = new Image();\n\t\t\n\t\t\tlocalStorageImage.addEventListener(\"load\", function(event)\n\t\t\t{\n\t\t\t\tlocalStorageImage.removeEventListener(event.type, arguments.callee, false);\n\t\t\t\tcontext.drawImage(localStorageImage,0,0,SCREEN_WIDTH-17,SCREEN_HEIGHT);\n\t\t\t}, false);\n\t\t\t\n\t\t\tlocalStorageImage.src = localStorage.canvas;\t\t\t\n\t\t}\n\t\t\n\t\tif (localStorage.brush_color_red)\n\t\t{\n\t\t\tCOLOR[0] = localStorage.brush_color_red;\n\t\t\tCOLOR[1] = localStorage.brush_color_green;\n\t\t\tCOLOR[2] = localStorage.brush_color_blue;\n\t\t}\n\n\t\tif (localStorage.background_color_red)\n\t\t{\n\t\t\tBACKGROUND_COLOR[0] = localStorage.background_color_red;\n\t\t\tBACKGROUND_COLOR[1] = localStorage.background_color_green;\n\t\t\tBACKGROUND_COLOR[2] = localStorage.background_color_blue;\n\t\t}\n\t}\n\n\tforegroundColorSelector.setColor( COLOR );\n\tbackgroundColorSelector.setColor( BACKGROUND_COLOR );\n\t\n\tif (window.location.hash)\n\t{\n\t\thash = window.location.hash.substr(1,window.location.hash.length);\n\n\t\tfor (i = 0; i < BRUSHES.length; i++)\n\t\t{\n\t\t\tif (hash == BRUSHES[i])\n\t\t\t{\n\t\t\t\tbrush = eval(\"new \" + BRUSHES[i] + \"(context)\");\n\t\t\t\tmenu.selector.selectedIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!brush)\n\t{\n\t\tbrush = eval(\"new \" + BRUSHES[0] + \"(context)\");\n\t}\n\t\n\t//about = new About();\n\t//container.appendChild(about.container);\n\t\n\twindow.addEventListener('mousemove', onWindowMouseMove, false);\n\twindow.addEventListener('resize', onWindowResize, false);\n\twindow.addEventListener('keydown', onWindowKeyDown, false);\n\twindow.addEventListener('keyup', onWindowKeyUp, false);\n\twindow.addEventListener('blur', onWindowBlur, false);\n\t\n\tdocument.addEventListener('mousedown', onDocumentMouseDown, false);\n\tdocument.addEventListener('mouseout', onDocumentMouseOut, false);\n\t\n\tdocument.addEventListener(\"dragenter\", onDocumentDragEnter, false);  \n\tdocument.addEventListener(\"dragover\", onDocumentDragOver, false);\n\tdocument.addEventListener(\"drop\", onDocumentDrop, false);  \n\t\n\tcanvas.addEventListener('mousedown', onCanvasMouseDown, false);\n\tcanvas.addEventListener('touchstart', onCanvasTouchStart, false);\n\tcanvas.style.position = 'absolute';\n\tcanvas.style.top = '0px';\n\tonWindowResize(null);\n}\n\n\n// WINDOW\n\nfunction onWindowMouseMove( event )\n{\n\tmouseX = event.clientX;\n\tmouseY = event.clientY;\n}\n\nfunction onWindowResize()\n{\n\tSCREEN_WIDTH = window.innerWidth;\n\tSCREEN_HEIGHT = Math.max(\n\t        Math.max(document.body.scrollHeight, document.documentElement.scrollHeight),\n\t        Math.max(document.body.offsetHeight, document.documentElement.offsetHeight),\n\t        Math.max(document.body.clientHeight, document.documentElement.clientHeight))+50;\n\t\n\tmenu.container.style.left = ((SCREEN_WIDTH - menu.container.offsetWidth) / 2) + 'px';\n\t\n\t//about.container.style.left = ((SCREEN_WIDTH - about.container.offsetWidth) / 2) + 'px';\n\t//about.container.style.top = ((SCREEN_HEIGHT - about.container.offsetHeight) / 2) + 'px';\n}\n\nfunction onWindowKeyDown( event )\n{\n\tif (shiftKeyIsDown)\n\t\treturn;\n\t\t\n\tswitch(event.keyCode)\n\t{\n\t\tcase 16: // Shift\n\t\t\tshiftKeyIsDown = true;\n\t\t\tforegroundColorSelector.container.style.left = mouseX - 125 + 'px';\n\t\t\tforegroundColorSelector.container.style.top = mouseY - 125 + 'px';\n\t\t\tforegroundColorSelector.container.style.visibility = 'visible';\n\t\t\tbreak;\n\t\t\t\n\t\tcase 18: // Alt\n\t\t\taltKeyIsDown = true;\n\t\t\tbreak;\n\t\t\t\n\t\tcase 68: // d\n\t\t\tif(BRUSH_SIZE > 1) BRUSH_SIZE --;\n\t\t\tbreak;\n\t\t\n\t\tcase 70: // f\n\t\t\tBRUSH_SIZE ++;\n\t\t\tbreak;\t\t\t\n\t}\n}\n\nfunction onWindowKeyUp( event )\n{\n\tswitch(event.keyCode)\n\t{\n\t\tcase 16: // Shift\n\t\t\tshiftKeyIsDown = false;\n\t\t\tforegroundColorSelector.container.style.visibility = 'hidden';\t\t\t\n\t\t\tbreak;\n\t\t\t\n\t\tcase 18: // Alt\n\t\t\taltKeyIsDown = false;\n\t\t\tbreak;\n\n\t\tcase 82: // r\n\t\t\tbrush.destroy();\n\t\t\tbrush = eval(\"new \" + BRUSHES[menu.selector.selectedIndex] + \"(context)\");\n\t\t\tbreak;\n\t\tcase 66: // b\n\t\t\tdocument.body.style.backgroundImage = null;\n\t\t\tbreak;\n\t}\n\t\n\tcontext.lineCap = BRUSH_SIZE == 1 ? 'butt' : 'round';\t\n}\n\nfunction onWindowBlur( event )\n{\n\tshiftKeyIsDown = false;\n\taltKeyIsDown = false;\n}\n\n\n// DOCUMENT\n\nfunction onDocumentMouseDown( event )\n{\n\t\n}\n\nfunction onDocumentMouseOut( event )\n{\n\tonCanvasMouseUp();\n}\n\nfunction onDocumentDragEnter( event )\n{\n\tevent.stopPropagation();\n\tevent.preventDefault();\n}\n\nfunction onDocumentDragOver( event )\n{\n\tevent.stopPropagation();\n\tevent.preventDefault();\n}\n\nfunction onDocumentDrop( event )\n{\n\tevent.stopPropagation();  \n\tevent.preventDefault();\n\t\n\tvar file = event.dataTransfer.files[0];\n\t\n\tif (file.type.match(/image.*/))\n\t{\n\t\t/*\n\t\t * TODO: This seems to work on Chromium. But not on Firefox.\n\t\t * Better wait for proper FileAPI?\n\t\t */\n\n\t\tvar fileString = event.dataTransfer.getData('text').split(\"\\n\");\n\t\tdocument.body.style.backgroundImage = 'url(' + fileString[0] + ')';\n\t}\t\n}\n\n\n// COLOR SELECTORS\n\nfunction onForegroundColorSelectorChange( event )\n{\n\tCOLOR = foregroundColorSelector.getColor();\n\t\n\tmenu.setForegroundColor( COLOR );\n\n\tif (STORAGE)\n\t{\n\t\tlocalStorage.brush_color_red = COLOR[0];\n\t\tlocalStorage.brush_color_green = COLOR[1];\n\t\tlocalStorage.brush_color_blue = COLOR[2];\t\t\n\t}\n}\n\nfunction onBackgroundColorSelectorChange( event )\n{\n\tBACKGROUND_COLOR = backgroundColorSelector.getColor();\n\t\n\tmenu.setBackgroundColor( BACKGROUND_COLOR );\n\t\n\tdocument.body.style.backgroundColor = 'rgb(' + BACKGROUND_COLOR[0] + ', ' + BACKGROUND_COLOR[1] + ', ' + BACKGROUND_COLOR[2] + ')';\n\t\n\tif (STORAGE)\n\t{\n\t\tlocalStorage.background_color_red = BACKGROUND_COLOR[0];\n\t\tlocalStorage.background_color_green = BACKGROUND_COLOR[1];\n\t\tlocalStorage.background_color_blue = BACKGROUND_COLOR[2];\t\t\t\t\n\t}\n}\n\n\n// MENU\n\nfunction onMenuForegroundColor()\n{\n\tcleanPopUps();\n\t\n\tforegroundColorSelector.show();\n\tforegroundColorSelector.container.style.left = ((SCREEN_WIDTH - foregroundColorSelector.container.offsetWidth) / 2) + 'px';\n\tforegroundColorSelector.container.style.top = ((SCREEN_HEIGHT - foregroundColorSelector.container.offsetHeight) / 2) + 'px';\n\n\tisFgColorSelectorVisible = true;\n}\n\nfunction onMenuBackgroundColor()\n{\n\tcleanPopUps();\n\n\tbackgroundColorSelector.show();\n\tbackgroundColorSelector.container.style.left = ((SCREEN_WIDTH - backgroundColorSelector.container.offsetWidth) / 2) + 'px';\n\tbackgroundColorSelector.container.style.top = ((SCREEN_HEIGHT - backgroundColorSelector.container.offsetHeight) / 2) + 'px';\n\n\tisBgColorSelectorVisible = true;\n}\n\nfunction onMenuSelectorChange()\n{\n\tif (BRUSHES[menu.selector.selectedIndex] == \"\")\n\t\treturn;\n\n\tbrush.destroy();\n\tbrush = eval(\"new \" + BRUSHES[menu.selector.selectedIndex] + \"(context)\");\n\n\twindow.location.hash = BRUSHES[menu.selector.selectedIndex];\n}\n\nfunction onMenuMouseOver()\n{\n\tisMenuMouseOver = true;\n}\n\nfunction onMenuMouseOut()\n{\n\tisMenuMouseOver = false;\n}\n\nfunction onMenuSave()\n{\n\tsetPageScroll();\n\t// window.open(canvas.toDataURL('image/png'),'mywindow');\n\tflatten();\n\t  var myForm = document.createElement(\"form\");\n\t  myForm.method=\"post\" ;\n\t  myForm.action = document.URL.split('#')[0] + \"/uploadBackground\";\n\t    var myInput = document.createElement(\"input\") ;\n\t    var myInput0 = document.createElement(\"input\");\n\t    myInput0.setAttribute(\"name\", \"type\");\n\t    myInput0.setAttribute(\"value\", \"file\");\n\t    myForm.appendChild(myInput0);\n\t    myInput.setAttribute(\"name\", \"f1\") ;\n\t    myInput.setAttribute(\"value\", flattenCanvas.toDataURL('image/png'));\n\t    myForm.appendChild(myInput) ;\n\t  document.body.appendChild(myForm) ;\n\t  myForm.submit() ;\n\t  document.body.removeChild(myForm) ;\n\t//window.open(flattenCanvas.toDataURL('image/png'),'mywindow');\n}\n\nfunction onMenuClear()\n{\n\tif (!confirm(\"Are you sure?\"))\n\t\treturn;\n\t\t\n\tcontext.clearRect(0, 0, SCREEN_WIDTH-17, SCREEN_HEIGHT);\n\n\tsaveToLocalStorage();\n\n\tbrush.destroy();\n\tbrush = eval(\"new \" + BRUSHES[menu.selector.selectedIndex] + \"(context)\");\n}\n\nfunction onMenuAbout()\n{\n\tcleanPopUps();\n\n\tisAboutVisible = true;\n\tabout.show();\n}\n\n\n// CANVAS\n\nfunction onCanvasMouseDown( event )\n{\n\tvar data, position;\n\n\tclearTimeout(saveTimeOut);\n\tcleanPopUps();\n\t\n\tif (altKeyIsDown)\n\t{\n\t\tflatten();\n\t\t\n\t\tdata = flattenCanvas.getContext(\"2d\").getImageData(0, 0, flattenCanvas.width, flattenCanvas.height).data;\n\t\tposition = (event.clientX + (event.clientY * canvas.width)) * 4;\n\t\t\n\t\tforegroundColorSelector.setColor( [ data[position], data[position + 1], data[position + 2] ] );\n\t\t\n\t\treturn;\n\t}\n\t\n\tBRUSH_PRESSURE = wacom && wacom.isWacom ? wacom.pressure : 1;\n\tbrush.strokeStart( coords[0], coords[1] );\n\n\twindow.addEventListener('mousemove', onCanvasMouseMove, false);\n\twindow.addEventListener('mouseup', onCanvasMouseUp, false);\n}\n\nfunction onCanvasMouseMove( event )\n{\n\tBRUSH_PRESSURE = wacom && wacom.isWacom ? wacom.pressure : 1;\n\t\n\tbrush.stroke( coords[0], coords[1] );\n}\n\nfunction onCanvasMouseUp()\n{\n\tbrush.strokeEnd();\n\t\n\twindow.removeEventListener('mousemove', onCanvasMouseMove, false);\n\twindow.removeEventListener('mouseup', onCanvasMouseUp, false);\n\t\n\tif (STORAGE)\n\t{\n\t\tclearTimeout(saveTimeOut);\n\t\tsaveTimeOut = setTimeout(saveToLocalStorage, 2000, true);\n\t}\n}\n\n\n//\n\nfunction onCanvasTouchStart( event )\n{\n\tcleanPopUps();\t\t\n\n\tif(event.touches.length == 1)\n\t{\n\t\tevent.preventDefault();\n\t\t\n\t\tbrush.strokeStart( event.touches[0].pageX, event.touches[0].pageY );\n\t\t\n\t\twindow.addEventListener('touchmove', onCanvasTouchMove, false);\n\t\twindow.addEventListener('touchend', onCanvasTouchEnd, false);\n\t}\n}\n\nfunction onCanvasTouchMove( event )\n{\n\tif(event.touches.length == 1)\n\t{\n\t\tevent.preventDefault();\n\t\tbrush.stroke( event.touches[0].pageX, event.touches[0].pageY );\n\t}\n}\n\nfunction onCanvasTouchEnd( event )\n{\n\tif(event.touches.length == 0)\n\t{\n\t\tevent.preventDefault();\n\t\t\n\t\tbrush.strokeEnd();\n\n\t\twindow.removeEventListener('touchmove', onCanvasTouchMove, false);\n\t\twindow.removeEventListener('touchend', onCanvasTouchEnd, false);\n\t}\n}\n\n//\n\nfunction saveToLocalStorage()\n{\n\tlocalStorage.canvas = canvas.toDataURL('image/png');\n}\n\nfunction flatten()\n{\n\tvar context = flattenCanvas.getContext(\"2d\");\n\t\n\tcontext.fillStyle = 'rgb(' + BACKGROUND_COLOR[0] + ', ' + BACKGROUND_COLOR[1] + ', ' + BACKGROUND_COLOR[2] + ')';\n\tcontext.fillRect(0, 0, canvas.width, canvas.height);\n\tcontext.drawImage(canvas, 0, 0);\n}\n\nfunction cleanPopUps()\n{\n\tif (isFgColorSelectorVisible)\n\t{\n\t\tforegroundColorSelector.hide();\n\t\tisFgColorSelectorVisible = false;\n\t}\n\t\t\n\tif (isBgColorSelectorVisible)\n\t{\n\t\tbackgroundColorSelector.hide();\n\t\tisBgColorSelectorVisible = false;\n\t}\n\t\n\tif (isAboutVisible)\n\t{\n\t\tabout.hide();\n\t\tisAboutVisible = false;\n\t}\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":14853}]],"length":14853}
{"contributors":[],"silentsave":false,"ts":1348800612985,"patch":[[{"diffs":[[0,"ndow');\n"],[-1,"\t"],[1,"    "],[0,"flatten("]],"start1":11225,"start2":11225,"length1":17,"length2":20},{"diffs":[[0,"();\n"],[-1,"\t"],[1,"  "],[0,"  var "],[-1,"myForm = document.createElement(\"form\""],[1,"data = new Object();\n    data.f1 = flattenCanvas.toDataURL('image/png'"],[0,");\n"],[-1,"\t"],[0,"  "],[-1,"myForm.method=\"post\" ;\n\t  myForm.action ="],[1,"  $.ajax({\n      type: 'POST',\n      url:"],[0," doc"]],"start1":11244,"start2":11244,"length1":100,"length2":132},{"diffs":[[0,"und\""],[-1,";\n\t"],[1,",\n"],[0,"    "],[-1,"var myInput = document.createElement(\"input\") ;\n\t    var myInput0 = document.createElement(\"input\");\n\t    myInput0.setAttribute(\"name\", \"type\");\n\t    myInput0.setAttribute(\"value\", \"file\");\n\t    myForm.appendChild(myInput0);\n\t    myInput.setAttribute(\"name\", \"f1\") ;\n\t    myInput.setAttribute(\"value\", flattenCanvas.toDataURL('image/png'));\n\t    myForm.appendChild(myInput) ;\n\t  document.body.appendChild(myForm) ;\n\t  myForm.submit() ;\n\t  document.body.removeChild(myForm) "],[1,"  data: data,\n      success: success(),\n      dataType: 'json',\n      cache: false,\n      async : false\n    })"],[0,";\n\t/"]],"start1":11417,"start2":11417,"length1":488,"length2":124}]],"length":14524,"saved":false}
{"ts":1348800849870,"patch":[[{"diffs":[[0,"ave()\n{\n"],[1,"    function successUploadBackground() {\n        alert('Saved!');\n    }\n"],[0,"\tsetPage"]],"start1":11148,"start2":11148,"length1":16,"length2":88},{"diffs":[[0," success"],[1,"UploadBackground"],[0,"(),\n    "]],"start1":11527,"start2":11527,"length1":16,"length2":32}]],"length":14612,"saved":false}
{"contributors":[],"silentsave":false,"ts":1348870176984,"patch":[[{"diffs":[[0,"EN_WIDTH"],[-1,"-17"],[0,";\n\tcanva"]],"start1":2718,"start2":2718,"length1":19,"length2":16},{"diffs":[[0,"EN_WIDTH"],[-1,"-17"],[0,";\n\tflatt"]],"start1":2946,"start2":2946,"length1":19,"length2":16},{"diffs":[[0,"EN_WIDTH"],[-1,"-17"],[0,",SCREEN_"]],"start1":4682,"start2":4682,"length1":19,"length2":16},{"diffs":[[0,"IDTH"],[-1,"-17"],[0,", SC"]],"start1":11789,"start2":11789,"length1":11,"length2":8}]],"length":14600,"saved":false}
{"ts":1348875684977,"patch":[[{"diffs":[[0,", true);\n\t}\n"],[1,"    \n    // Save the background asynchronously in the background\n    function successUploadBackground() {\n        \n    }\n    flatten();\n    var data = new Object();\n    data.f1 = flattenCanvas.toDataURL('image/png');\n    $.ajax({\n      type: 'POST',\n      url: document.URL.split('#')[0] + \"/uploadBackground\",\n      data: data,\n      success: successUploadBackground(),\n      dataType: 'json',\n      cache: false,\n      async : false\n    });\n"],[0,"}\n\n\n//\n\nfunc"]],"start1":13131,"start2":13131,"length1":24,"length2":467}]],"length":15043,"saved":false}
{"ts":1348875825372,"patch":[[{"diffs":[[0,"\n\t}\n"],[-1,"    \n    // Save the background asynchronously in the background\n    function successUploadBackground() {\n        \n    }\n    flatten();\n    var data = new Object();\n    data.f1 = flattenCanvas.toDataURL('image/png');\n    $.ajax({\n      type: 'POST',\n      url: document.URL.split('#')[0] + \"/uploadBackground\",\n      data: data,\n      success: successUploadBackground(),\n      dataType: 'json',\n      cache: false,\n      async : false\n    });\n"],[0,"}\n\n\n"]],"start1":13139,"start2":13139,"length1":451,"length2":8}]],"length":14600,"saved":false}
{"ts":1348875873066,"patch":[[{"diffs":[[0,"nd, false);\n"],[1,"        \n        // Save the background asynchronously in the background\n        function successUploadBackground() {\n            \n        }\n        flatten();\n        var data = new Object();\n        data.f1 = flattenCanvas.toDataURL('image/png');\n        $.ajax({\n          type: 'POST',\n          url: document.URL.split('#')[0] + \"/uploadBackground\",\n          data: data,\n          success: successUploadBackground(),\n          dataType: 'json',\n          cache: false,\n          async : false\n        });\n"],[0,"\t}\n}\n\n//\n\nfu"]],"start1":13898,"start2":13898,"length1":24,"length2":535}]],"length":15111,"saved":false}
{"ts":1348875961134,"patch":[[{"diffs":[[0,"e);\n"],[-1,"        \n        // Save the background asynchronously in the background\n        function successUploadBackground() {\n            \n        }\n        flatten();\n        var data = new Object();\n        data.f1 = flattenCanvas.toDataURL('image/png');\n        $.ajax({\n          type: 'POST',\n          url: document.URL.split('#')[0] + \"/uploadBackground\",\n          data: data,\n          success: successUploadBackground(),\n          dataType: 'json',\n          cache: false,\n          async : false\n        });"],[0,"\n\t}\n"]],"start1":13906,"start2":13906,"length1":518,"length2":8}]],"length":14601,"saved":false}
{"ts":1348876106006,"patch":[[{"diffs":[[0,"size()\n{"],[1,"alert('hi');"],[0,"\n\tSCREEN"]],"start1":6712,"start2":6712,"length1":16,"length2":28}]],"length":14613,"saved":false}
{"ts":1348876134084,"patch":[[{"diffs":[[0,"()\n{"],[-1,"alert('hi');"],[0,"\n\tSC"]],"start1":6716,"start2":6716,"length1":20,"length2":8}]],"length":14601,"saved":false}
{"ts":1348876209861,"patch":[[{"diffs":[[0,"seUp()\n{"],[1,"alert('hi');"],[0,"\n\tbrush."]],"start1":12869,"start2":12869,"length1":16,"length2":28}]],"length":14613,"saved":false}
{"ts":1348876374390,"patch":[[{"diffs":[[0," false);\n\t\n\t"],[-1,"document"],[1,"canvas"],[0,".addEventLis"]],"start1":6018,"start2":6018,"length1":32,"length2":30},{"diffs":[[0,"n, false);\n\t"],[-1,"document"],[1,"canvas"],[0,".addEventLis"]],"start1":6085,"start2":6085,"length1":32,"length2":30},{"diffs":[[0,"()\n{"],[-1,"alert('hi');"],[0,"\n\tbr"]],"start1":12869,"start2":12869,"length1":20,"length2":8}]],"length":14597,"saved":false}
{"ts":1348876460099,"patch":[[{"diffs":[[0,"vent )\n{"],[1,"alert('hi');"],[0,"\n\tvar da"]],"start1":12054,"start2":12054,"length1":16,"length2":28}]],"length":14609,"saved":false}
{"ts":1348876483886,"patch":[[{"diffs":[[0," )\n{"],[-1,"alert('hi');"],[0,"\n\tva"]],"start1":12058,"start2":12058,"length1":20,"length2":8},{"diffs":[[0,", true);\n\t}\n"],[1,"    \n    // Save the background asynchronously in the background\n    function successUploadBackground() {\n        \n    }\n    flatten();\n    var data = new Object();\n    data.f1 = flattenCanvas.toDataURL('image/png');\n    $.ajax({\n      type: 'POST',\n      url: document.URL.split('#')[0] + \"/uploadBackground\",\n      data: data,\n      success: successUploadBackground(),\n      dataType: 'json',\n      cache: false,\n      async : false\n    });\n"],[0,"}\n\n\n//\n\nfunc"]],"start1":13127,"start2":13127,"length1":24,"length2":467}]],"length":15040,"saved":false}
{"ts":1348876573275,"patch":[[{"diffs":[[0,"   \n"],[-1,"    // Save the background asynchronously in the background\n    function successUploadBackground() {\n        \n    }\n    flatten();\n    var data = new Object();\n    data.f1 = flattenCanvas.toDataURL('image/png');\n    $.ajax({\n      type: 'POST',\n      url: document.URL.split('#')[0] + \"/uploadBackground\",\n      data: data,\n      success: successUploadBackground(),\n      dataType: 'json',\n      cache: false,\n      async : false\n    });\n"],[0,"}\n\n\n"]],"start1":13140,"start2":13140,"length1":446,"length2":8}]],"length":14602,"saved":false}
{"ts":1348876594536,"patch":[[{"diffs":[[0,"seUp()\n{"],[1,"alert('hi');"],[0,"\n\tbrush."]],"start1":12865,"start2":12865,"length1":16,"length2":28}]],"length":14614,"saved":false}
{"ts":1348876622141,"patch":[[{"diffs":[[0,"()\n{"],[-1,"alert('hi');"],[0,"\n\tbr"]],"start1":12869,"start2":12869,"length1":20,"length2":8}]],"length":14602,"saved":false}
{"contributors":[],"silentsave":false,"ts":1348945031864,"patch":[[{"diffs":[[0," false);\n\t\n\t"],[-1,"canvas"],[1,"document"],[0,".addEventLis"]],"start1":6018,"start2":6018,"length1":30,"length2":32},{"diffs":[[0,"eDown, false);\n\t"],[-1,"canvas"],[1,"document"],[0,".addEventListene"]],"start1":6083,"start2":6083,"length1":38,"length2":40}]],"length":14606,"saved":false}
{"ts":1348945090414,"patch":[[{"diffs":[[0,"ize()\n{\n"],[1,"    resizeFirst();\n"],[0,"\tSCREEN_"]],"start1":6713,"start2":6713,"length1":16,"length2":35}]],"length":14625,"saved":false}
{"ts":1348945174095,"patch":[[{"diffs":[[0,")\n{\n"],[-1,"    resizeFirst();\n"],[0,"\tSCR"]],"start1":6717,"start2":6717,"length1":27,"length2":8}]],"length":14606,"saved":false}
{"ts":1348946563140,"patch":[[{"diffs":[[0,"oll();\n\t"],[-1,"// "],[0,"window.o"]],"start1":11230,"start2":11230,"length1":19,"length2":16}]],"length":14603,"saved":false}
{"ts":1348946619927,"patch":[[{"diffs":[[0,"oDataURL('image/"],[1,"j"],[0,"p"],[-1,"n"],[0,"g'),'mywindow');"]],"start1":11258,"start2":11258,"length1":34,"length2":34}]],"length":14603,"saved":false}
{"ts":1348946646522,"patch":[[{"diffs":[[0,"age/"],[-1,"j"],[0,"p"],[1,"n"],[0,"g'),"]],"start1":11270,"start2":11270,"length1":10,"length2":10}]],"length":14603,"saved":false}
{"ts":1348946690618,"patch":[[{"diffs":[[0,"        "],[1,"//"],[0,"alert('S"]],"start1":11188,"start2":11188,"length1":16,"length2":18}]],"length":14605,"saved":false}
{"ts":1348946809096,"patch":[[{"diffs":[[0,"eScroll();\n\t"],[1,"//"],[0,"window.open("]],"start1":11228,"start2":11228,"length1":24,"length2":26},{"diffs":[[0,"se\n    });\n\t"],[-1,"//"],[0,"window.open("]],"start1":11608,"start2":11608,"length1":26,"length2":24}]],"length":14605,"saved":false}
{"ts":1348946839726,"patch":[[{"diffs":[[0,"oDataURL('image/"],[1,"j"],[0,"p"],[-1,"n"],[0,"g'),'mywindow');"]],"start1":11647,"start2":11647,"length1":34,"length2":34}]],"length":14605,"saved":false}
{"ts":1348946862078,"patch":[[{"diffs":[[0,"age/"],[-1,"j"],[0,"p"],[1,"n"],[0,"g'),"]],"start1":11659,"start2":11659,"length1":10,"length2":10}]],"length":14605,"saved":false}
{"ts":1348946878256,"patch":[[{"diffs":[[0,"oDataURL('image/"],[1,"j"],[0,"p"],[-1,"n"],[0,"g'),'mywindow');"]],"start1":11647,"start2":11647,"length1":34,"length2":34}]],"length":14605,"saved":false}
{"ts":1348946892516,"patch":[[{"diffs":[[0,"age/"],[-1,"j"],[0,"p"],[1,"n"],[0,"g'),"]],"start1":11659,"start2":11659,"length1":10,"length2":10}]],"length":14605,"saved":false}
{"contributors":[],"silentsave":false,"ts":1349309147114,"patch":[[{"diffs":[[0,"se\n    });\n\t"],[1,"//"],[0,"window.open("]],"start1":11608,"start2":11608,"length1":24,"length2":26}]],"length":14607,"saved":false}
